version: 2

models:
  - name: rpt_daily_sales
    description: Daily sales summary report with order counts, revenue, day-over-day comparisons, and rolling averages
    config:
      tags:
        - layer:reporting
        - domain:sales
        - category:performance
        - cadence:hourly
    columns:
      - name: sale_date
        description: Calendar date of sales activity
        data_type: date
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: total_orders
        description: Total number of orders placed on this date
        data_type: int64
      - name: total_revenue
        description: Sum of all order values for this date
        data_type: numeric
      - name: avg_order_value
        description: Average order value for this date
        data_type: numeric
      - name: prev_day_orders
        description: Total orders from the previous day (LAG window function)
        data_type: int64
      - name: prev_day_revenue
        description: Total revenue from the previous day (LAG window function)
        data_type: numeric
      - name: orders_dod_change
        description: Day-over-day change in order count (current - previous)
        data_type: int64
      - name: revenue_dod_change
        description: Day-over-day change in revenue (current - previous)
        data_type: numeric
      - name: orders_dod_pct_change
        description: Day-over-day percent change in orders
        data_type: numeric
      - name: revenue_dod_pct_change
        description: Day-over-day percent change in revenue
        data_type: numeric
      - name: revenue_7day_avg
        description: 7-day rolling average of revenue (current day + 6 preceding days)
        data_type: numeric

  - name: rpt_top_customers
    description: Customer ranking report ordered by lifetime total spend
    config:
      tags:
        - layer:reporting
        - domain:customers
        - category:performance
        - cadence:daily
    columns:
      - name: customer_id
        description: Unique identifier for each customer
        data_type: int64
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: customer_name
        description: Full name of the customer
        data_type: string
      - name: email
        description: Customer email address
        data_type: string
      - name: order_count
        description: Total number of orders placed
        data_type: int64
      - name: total_spent
        description: Lifetime total amount spent
        data_type: numeric
      - name: first_order
        description: Date of the customer's first order
        data_type: timestamp
      - name: last_order
        description: Date of the customer's most recent order
        data_type: timestamp

  - name: rpt_category_sales
    description: Sales performance report aggregated by product category
    config:
      tags:
        - layer:reporting
        - domain:products
        - category:performance
        - cadence:daily
    columns:
      - name: category
        description: Product category name
        data_type: string
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: order_count
        description: Number of distinct orders containing products from this category
        data_type: int64
      - name: units_sold
        description: Total number of units sold in this category
        data_type: int64
      - name: revenue
        description: Total revenue generated by this category
        data_type: numeric
