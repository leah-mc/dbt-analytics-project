version: 2

models:
  - name: dim_customers
    description: Customer dimension table with aggregated order metrics and lifetime value
    config:
      tags:
        - layer:marts
        - domain:customers
        - category:dimension
        - cadence:hourly
    columns:
      - name: customer_id
        description: Unique identifier for each customer
        data_type: int64
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: customer_name
        description: Full name of the customer
        data_type: string
      - name: email
        description: Customer email address
        data_type: string
      - name: created_at
        description: Timestamp when the customer record was created
        data_type: timestamp
      - name: order_count
        description: Total number of orders placed by the customer
        data_type: int64
      - name: total_spent
        description: Lifetime total amount spent by the customer
        data_type: numeric
      - name: first_order
        description: Date of the customer's first order
        data_type: timestamp
      - name: last_order
        description: Date of the customer's most recent order
        data_type: timestamp

  - name: dim_products
    description: Product dimension table with aggregated sales metrics
    config:
      tags:
        - layer:marts
        - domain:products
        - category:dimension
        - cadence:hourly
    columns:
      - name: product_id
        description: Unique identifier for each product
        data_type: int64
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: product_name
        description: Display name of the product
        data_type: string
      - name: category
        description: Product category classification
        data_type: string
      - name: price
        description: Current unit price of the product
        data_type: numeric
      - name: units_sold
        description: Total number of units sold across all orders
        data_type: int64
      - name: revenue
        description: Total revenue generated by this product
        data_type: numeric

  - name: fct_orders
    description: Order fact table with denormalized customer information
    config:
      tags:
        - layer:marts
        - domain:orders
        - category:fact
        - cadence:hourly
    columns:
      - name: order_id
        description: Unique identifier for each order
        data_type: int64
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: customer_id
        description: Foreign key to the customer dimension
        data_type: int64
      - name: customer_name
        description: Full name of the customer (denormalized)
        data_type: string
      - name: order_status
        description: Current status of the order
        data_type: string
      - name: order_date
        description: Date and time when the order was placed
        data_type: timestamp
      - name: order_total
        description: Total monetary value of the order
        data_type: numeric
      - name: item_count
        description: Total number of line items in the order
        data_type: int64

  - name: fct_order_items
    description: Order line items fact table with denormalized product and order details
    config:
      tags:
        - layer:marts
        - domain:orders
        - category:fact
        - cadence:hourly
    columns:
      - name: order_item_id
        description: Unique identifier for each order line item
        data_type: int64
        config:
          meta:
            primary_key: true
        data_tests:
          - unique
          - not_null
      - name: order_id
        description: Foreign key to the order fact
        data_type: int64
      - name: customer_id
        description: Foreign key to the customer dimension
        data_type: int64
      - name: order_date
        description: Date when the order was placed
        data_type: timestamp
      - name: product_id
        description: Foreign key to the product dimension
        data_type: int64
      - name: product_name
        description: Display name of the product (denormalized)
        data_type: string
      - name: category
        description: Product category (denormalized)
        data_type: string
      - name: quantity
        description: Number of units purchased
        data_type: int64
      - name: unit_price
        description: Price per unit at time of purchase
        data_type: numeric
      - name: line_total
        description: Total value for this line item
        data_type: numeric
